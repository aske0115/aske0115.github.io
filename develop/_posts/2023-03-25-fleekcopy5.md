# SwiftUI + Combineì„ ì´ìš©í•˜ì—¬ Fleek Copy app ë§Œë“¤ê¸°(3-3)

ì•ˆë…•í•˜ì„¸ìš”. 

ì˜¤ëŠ˜ì€ [**ì´ì „ í¬ìŠ¤íŠ¸**](https://aske0115.github.io/develop/2023-03-23-fleekcopy4/)ì— ë§í–ˆë˜ ê²ƒ ì²˜ëŸ¼, Introí™”ë©´ì´ ì§„í–‰ëœ í›„ ë©”ì¸í™”ë©´ì´ ë…¸ì¶œë  ë•Œ, ìì—°ìŠ¤ëŸ¬ìš´ splash ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì „í™˜ë˜ë„ë¡ í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

---

ê°„ë‹¨í•œ ideaë¥¼ ë– ì˜¬ë ¤ ë³´ë©´, isCompleteê°€ ë˜ì—ˆì„ ë•Œ, ì¸íŠ¸ë¡œì˜ alphaëŠ” ì„œì„œíˆ ì¤„ì–´ë“¤ê³  mainTabViewì˜ alphaëŠ” ì„œì„œíˆ ì¦ê°€í•˜ë©´ì„œ ë…¸ì¶œë˜ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ë°”ë¡œ ì½”ë“œë¡œ ì ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.

```swift
import SwiftUI
import Combine

struct SplashView: View  {
    @State private var progress: Float = 0.0
    @State private var isComplete: Bool = false
    
    let duration: Double = 3.0
    
    var timer: Publishers.Autoconnect<Timer.TimerPublisher> {
           Timer.publish(every: 0.01, on: .main, in: .common).autoconnect()
    }
    
    var body: some View {
        Group {
            if !isComplete {
                VStack {
                    Text("FLEEK")
                        .foregroundColor(.red)
                        .fontWeight(.heavy)
                        .font(.largeTitle)
                    Text("ë‹¹ì‹ ì˜ ìš´ë™ì„ ì˜ë¯¸ìˆê²Œ!")
                        .foregroundColor(.white)
                    
                    ProgressView(value: progress)
                        .animation(.linear(duration: duration), value: progress)
                        .tint(.red)
                        .frame(width: 160)
                }
                
                .opacity(isComplete ? 0 : 1)
                .frame(maxWidth: .infinity, maxHeight: .infinity)
                .background(.black)
            } else {
                MainTabView()
                    .opacity(isComplete ? 1 : 0)
            }
        }
        .onReceive(timer) { _ in
            if progress < 1.0 {
                progress = min(1.0, progress + 0.004)
            } else {
                withAnimation(.easeOut(duration: 1.0)) {
                    isComplete = true
                }
            }
        }
    }
}
```

---

opacityë¼ëŠ” ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

í•´ë‹¹ ë©”ì†Œë“œì˜ ì„¤ëª…ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

## opacity(_:)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-25 á„‹á…©á„Œá…¥á†« 12.21.13.png](/assets/img/blog/fleekCopy/opacitydoc.png)

> ê°„ë‹¨ëª…ë£Œí•©ë‹ˆë‹¤.. ë·°ì˜ íˆ¬ëª…ë„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
> 

ìœ„ì˜ ì½”ë“œë¥¼ ë‹¤ì‹œ ëŒì•„ê°€ë³´ë©´,..

- VStackìœ¼ë¡œ ë‘˜ëŸ¬ìŒ“ì¸ IntroViewì˜ opacityëŠ” isCompleteê°€ trueì´ë©´ 0, falseì´ë©´ 1ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.
- MainTabView()ì˜ opacityëŠ” ê·¸ ë°˜ëŒ€ë¡œ isCompleteê°€ trueì´ë©´ 1, falseì´ë©´ 0ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  ì¶”ê°€ì ìœ¼ë¡œ WithAnimationì´ë¼ëŠ” ë¶€ë¶„ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.

## **withAnimation(_:_:)**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-25 á„‹á…©á„Œá…¥á†« 12.23.54.png](/assets/img/blog/fleekCopy/withanimationdoc.png)

> ì„¤ì •ëœ animation (linear, easein, easeOut ë“±..)ì„ ì²˜ë¦¬í•˜ì—¬ ê³„ì‚°ëœ Resultë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
> 
- ìœ„ì—ì„œ ë³´ìë©´ easeOutìœ¼ë¡œ ë™ì‘í•˜ëŠ” animationì„ body closureì—ì„œ ë³€ê²½í•˜ëŠ” isCompleteì˜ ì²˜ë¦¬ë™ì‘ì„ ë‹¤ì‹œì²˜ë¦¬í•˜ì—¬ ë¦¬í„´í•´ì¤ë‹ˆë‹¤.
- isCompleteê°’ì´ ë³€ê²½ë˜ë©´ viewì˜ ê°±ì‹ ì´ ìˆ˜í–‰ë˜ëŠ”ë°, í•´ë‹¹ ê°±ì‹ ì‘ì—…ì˜ ê²°ê³¼ë¬¼ì— ì„¤ì •í•œ ì• ë‹ˆë©”ì´ì…˜ì´ recomputeëœ ê²°ê³¼ë¬¼ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

---

ë§ë¡œ ì„¤ëª…ì´ ì–´ë ¤ìš°ë‹ˆ ë¹Œë“œí•´ì„œ ê²°ê³¼í™”ë©´ì„ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

![Simulator Screen Recording - iPhone 14 Pro - 2023-03-25 at 00.29.03.gif](/assets/img/blog/fleekCopy/groupsplash.gif)

---

ë­”ê°€ ì›í•˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ë„ ë™ì‘í•˜ê³ , ë­”ê°€ splashê°€ ë˜ëŠ”ê²ƒ ê°™ìŠµë‹ˆë‹¤.

<aside>
ğŸ¤” ê·¼ë° ë­”ê°€ ì–´ìƒ‰í•©ë‹ˆë‹¤.. ì–´ë”˜ê°€ ëª¨ë¥´ê²Œ ë¶€ìì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.
í°ìƒ‰ì´ ë…¸ì¶œë˜ëŠ”ê²Œ ê·¸ ì´ìœ ì¸ê²ƒ ê°™ì•„ë³´ì…ë‹ˆë‹¤.

</aside>

- Groupìœ¼ë¡œ ë¬¶ì¸ introViewì™€ mainTabViewê°€ isCompleteì— ë°˜ì‘í•˜ì—¬ í•˜ë‚˜ëŠ” ì‚¬ë¼ì§€ê³  í•˜ë‚˜ëŠ” ë³´ì—¬ì§€ëŠ” í˜•íƒœê°€ ë¬¸ì œì¸ê²ƒ ê°™ìŠµë‹ˆë‹¤.
    - ì œê°€ ì›í•˜ëŠ”ê±´ ì¸íŠ¸ë¡œê°€ ì„œì„œíˆ ì‚¬ë¼ì§€ê³ , ë©”ì¸ë·°ê°€ ì„œì„œíˆ ë‚˜íƒ€ë‚˜ëŠ” í˜•íƒœì…ë‹ˆë‹¤.
- ìƒê°ì„ ë°”ê¿”ë´…ë‹ˆë‹¤. isCompleteì— ë”°ë¼ ë·°ê°€ ë³´ì—¬ì§€ëŠ” í˜•íƒœê°€ ì•„ë‹Œ, ë‘ê°œì˜ ë·°ê°€ ê³„ì¸µì„ ë‘ê³  ë…¸ì¶œë˜ì–´ìˆëŠ” ìƒíƒœì—ì„œ ì•ì˜ ë·°ëŠ” ì„œì„œíˆ ì‚¬ë¼ì§€ê³  ë’¤ì˜ ë·°ëŠ” ì„œì„œíˆ ë‚˜íƒ€ë‚˜ë„ë¡ ë³€ê²½í•´ë³´ê² ìŠµë‹ˆë‹¤.

---

GroupëŒ€ì‹  ZStackì„ ì‚¬ìš©í•´ë´…ë‹ˆë‹¤.

## **ZStack**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-25 á„‹á…©á„Œá…¥á†« 12.33.39.png](/assets/img/blog/fleekCopy/zstackdoc.png)

> Subviewë“¤ì„ zIndexë¥¼ ë‹¤ë£¨ë˜ ê²ƒê³¼ ê°™ì´, ê·¸ë¦¼ì—ì„œ ë³´ë“¯ì´ ìƒ‰ì¢…ì´ë¥¼ í•œì¥í•œì¥ ìŒ“ì•„ë‘ëŠ” ê²ƒ ì²˜ëŸ¼ ê° Viewì˜ zIndex Hierachyë¥¼ ì •ë ¬í•˜ëŠ” ë·° ì…ë‹ˆë‹¤.
> 

1. Groupì„ ZStackìœ¼ë¡œ ë³€ê²½í•´ì¤ë‹ˆë‹¤.
2. if !iscomplete ì— ë”°ë¼ ë…¸ì¶œí•  ë·°ë¥¼ ë³€ê²½í•˜ëŠ” ë¶€ë¶„ì„ ì œê±°í•©ë‹ˆë‹¤.
3. ZStackì— IntroViewì™€ mainTabViewë¥¼ ì°¨ë¡€ëŒ€ë¡œ ì‚½ì…í•©ë‹ˆë‹¤.
4. ìœ„ì— ì„¤ëª…í–ˆë˜ê²ƒ ì²˜ëŸ¼ opacityë¥¼ í†µí•´ì„œ introViewëŠ” ì‚¬ë¼ì§€ê³ , mainTabViewëŠ” ë‚˜íƒ€ë‚˜ë„ë¡ í•´ì¤ë‹ˆë‹¤.

---

```swift
import SwiftUI
import Combine

struct SplashView: View  {
    @State private var progress: Float = 0.0
    @State private var isComplete: Bool = false
    
    let duration: Double = 3.0
    
    var timer: Publishers.Autoconnect<Timer.TimerPublisher> {
           Timer.publish(every: 0.01, on: .main, in: .common).autoconnect()
    }
    
    var body: some View {
        ZStack {
            VStack {
                Text("FLEEK")
                    .foregroundColor(.red)
                    .fontWeight(.heavy)
                    .font(.largeTitle)
                Text("ë‹¹ì‹ ì˜ ìš´ë™ì„ ì˜ë¯¸ìˆê²Œ!")
                    .foregroundColor(.white)
                
                ProgressView(value: progress)
                    .animation(.linear(duration: duration), value: progress)
                    .tint(.red)
                    .frame(width: 160)
            }
            .opacity(isComplete ? 0 : 1)
            .frame(maxWidth: .infinity, maxHeight: .infinity)
            .background(.black)
            MainTabView()
                .opacity(isComplete ? 1 : 0)
        }
        .onReceive(timer) { _ in
            if progress < 1.0 {
                progress = min(1.0, progress + 0.004)
            } else {
                withAnimation(.easeOut(duration: 1.0)) {
                    isComplete = true
                }
            }
        }
    }
}
```

Group ì—ì„œ ZStackìœ¼ë¡œ ë³€ê²½í•œ í›„ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

![Simulator Screen Recording - iPhone 14 Pro - 2023-03-25 at 00.43.38.gif](/assets/img/blog/fleekCopy/zstacksplash.gif)

<aside>
ğŸ˜€ ì›í•˜ëŠ”ëŒ€ë¡œ ì˜ ë™ì‘í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</aside>

---

ê·¸ëŸ°ë° ê°‘ìê¸° timerê°€ ì‹ ê²½ì“°ì…ë‹ˆë‹¤.. ğŸ˜Ÿ

ë·°ëŠ” ê°±ì‹ ì„ í•˜ëŠ”ë°, timerëŠ”?? ëˆ„ê°€ ì‹ ê²½ì¨ì£¼ì§€? timerëŠ” ê³„ì† ëŒê³ ìˆëŠ”ê±° ì•„ë‹ê¹Œ??

printë¬¸ì„ ì¶”ê°€í•´ì„œ í™•ì¸í•´ë³´ì•˜ìŠµë‹ˆë‹¤

```swift
...
.onReceive(timer) { _ in
   print("timer is Running \(Date().timeIntervalSince1970)")
     if progress < 1.0 {
        progress = min(1.0, progress + 0.004)
     } else {
        withAnimation(.easeOut(duration: 1.0)) {
           isComplete = true
           print("progress complete")
        }
 }
...
```

```swift
timer is Running 1679672821.315446
timer is Running 1679672821.3281121
timer is Running 1679672821.340901
progress complete
timer is Running 1679672821.353378
progress complete
timer is Running 1679672821.36378
progress complete
timer is Running 1679672821.3728452
progress complete
timer is Running 1679672821.383811
progress complete
timer is Running 1679672821.39377
progress complete
timer is Running 1679672821.404144
progress complete
timer is Running 1679672821.414058
progress complete
timer is Running 1679672821.4232578
progress complete
timer is Running 1679672821.433852
progress complete
timer is Running 1679672821.4438272
progress complete
timer is Running 1679672821.454082
progress complete
timer is Running 1679672821.4638371
```

<aside>
ğŸ˜² progress completeê°€ í˜¸ì¶œëœ ì´í›„ë¡œë„ timerëŠ” ì‚´ì•„ì„œ ê³„ì† ëŒì•„ê°‘ë‹ˆë‹¤â€¦

</aside>

ë­”ê°€ ëë‚´ê³  ì‹¶ì—ˆëŠ”ë° ì°œì°œí•¨ì´ ë˜ ë‚¨ì•˜ìŠµë‹ˆë‹¤..

Combineì„ ì„¤ëª…í•´ì•¼ í•  ë¶€ë¶„ì´ ìƒê¸´ê²ƒ ê°™ì•„ì„œ ì˜¤ëŠ˜ì˜ ê¸€ì€ ì´ì •ë„ë¡œ ë§ˆë¬´ë¦¬í•˜ê³ , 

ë‹¤ìŒ ê¸€ë¡œ ì´ì–´ì„œ ì‘ì„±í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.
